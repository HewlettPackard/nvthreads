CC      = /home/dhc/multicore/llvm/llvm/Debug+Asserts/bin/clang
CPP     = /home/dhc/multicore/llvm/llvm/Debug+Asserts/bin/clang++

W       = -W -Wall -Wno-unused-parameter -Wbad-function-cast

OPT = -O0 -g

CFLAGS  = -pthread $(OPT) $(W) $(XCFLAGS)

# placeholder below, needs to be set
ATLAS_ROOTDIR      = /home/bhandark/Atlas
ATLAS_SRCDIR       = $(ATLAS_ROOTDIR)/src
ATLAS_INCDIR       = $(ATLAS_ROOTDIR)/include
ATLAS_INT_INCDIR   = $(ATLAS_SRCDIR)/internal_includes
ATLAS_LIBDIR       = $(ATLAS_ROOTDIR)/lib
ATLAS_TOOLDIR      = $(ATLAS_ROOTDIR)/tools

# placeholder below, needs to be set
ATOMIC_OPS_ROOTDIR = /home/bhandark/libs
ATOMIC_OPS_INCDIR  = $(ATOMIC_OPS_ROOTDIR)/include
ATOMIC_OPS_LIBDIR  = $(ATOMIC_OPS_ROOTDIR)/lib

LIBATLAS           = $(ATLAS_LIBDIR)/libatlas.a

ATLAS_CFLAGS       =   $(COMMON_CFLAGS) -I$(ATLAS_INCDIR) \
                        -I$(ATLAS_INT_INCDIR) -I$(ATOMIC_OPS_INCDIR)

ATLAS_LDFLAGS      =   -L$(ATLAS_LIBDIR) -latlas \
                        -L$(ATOMIC_OPS_LIBDIR) -latomic_ops \
                        -lrt -lpthread
# MDB and LevelDB library placeholder
MDB_LIBDIR = /home/bhandark/Atlas/examples/mdb/mdb_nvm
LEVELDB_LIBDIR = /home/bhandark/Atlas/examples/mdb/leveldb-bench/leveldb
LEVELDB_INCDIR = /home/bhandark/Atlas/examples/mdb/leveldb-bench/leveldb/include

DB_LDFLAGS = -L$(LEVELDB_LIBDIR) -lleveldb -L$(MDB_LIBDIR) -lmdb
DB_CPPFLAGS = -I$(LEVELDB_INCDIR)

.PHONY: clean

PROGS = mdb_bench_nvm

all: $(PROGS)

mdb_bench_nvm: db_bench_mdb.o testutil.o
	$(CPP) $(CFLAGS) $^ -std=gnu89 -fPIC  $(DB_LDFLAGS) $(ATLAS_LDFLAGS)  -o $@
 
%.o: %.cc
	$(CPP) $(CFLAGS) -fPIC $(ATLAS_CFLAGS) $(DB_CPPFLAGS) -c $<


clean:
	-rm -rf $(PROGS) *.o 
